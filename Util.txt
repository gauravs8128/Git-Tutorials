this is utility functions of version 1